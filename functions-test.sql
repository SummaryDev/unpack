/*
playground to manually test abi decoding defined in functions.sql

https://github.com/web3/web3.js/blob/1.x/test/abi.decodeParameter.js
 */

select to_uint32(0, '0000000000000000000000000000000000000000000000000000000000000000');
select to_uint32(0, '0000000000000000000000000000000000000000000000000000000000000001'); -- 1
select to_uint32(0, '00000001'); -- 1 still
select to_uint32(0, '1');
select to_uint32(0, '0000000000000000000000000000000000000000000000000000000000000010');
select to_uint32(0, '000000000000000000000000000000000000000000000000000000000000000f');
select to_uint32(0, '00000000000000000000000000000000000000000000000000000000ffffffff'); -- 4294967295
select to_uint32(0, '0000000000000000000000000000000000000000000000000000000fffffffff'); -- 4294967295 still
select to_uint32(0, 'ffffffffffffffff'); -- 4294967295 still
select to_uint32(0, 'ff');

select to_uint64(0, '0000000000000000000000000000000000000000000000000000000000000000');
select to_uint64(0, '0000000000000000000000000000000000000000000000000000000000000001'); -- 1
select to_uint64(0, '00000000000000000000000000000001'); -- 1 still
select to_uint64(0, '0000000000000001'); -- 1 still
select to_uint64(0, '1');
select to_uint64(0, '0000000000000000000000000000000000000000000000000000000000000010');
select to_uint64(0, '000000000000000000000000000000000000000000000000000000000000000f');
select to_uint64(0, '000000000000000000000000000000000000000000000000ffffffffffffffff'); -- 18446744073709551615 on postgres, 9223372036854775807 on redshift
select to_uint64(0, '0000000000000000000000000000000000000000000000007fffffffffffffff'); -- TODO 9223372036854775807 maximum on redshift prevent loss of precision
select to_uint64(0, '0000000000000000000000000000000000000000000000008fffffffffffffff'); -- still 9223372036854775807 maximum on redshift
select to_uint64(0, '000000000000000000000000000000000000000000000fffffffffffffffffff'); -- still 18446744073709551615 on postgres, 9223372036854775807 on redshift
select to_uint64(0, '7fffffffffffffff'); -- still 18446744073709551615 on postgres, 9223372036854775807 on redshift

select to_int32(0, '0000000000000000000000000000000000000000000000000000000000000000');
select to_int32(0, '0000000000000000000000000000000000000000000000000000000000000001'); -- 1
select to_int32(0, '00000000000000000000000000000001'); -- 1 still
select to_int32(0, '1');
select to_int32(0, '0000000000000000000000000000000000000000000000000000000000000010');
select to_int32(0, '000000000000000000000000000000000000000000000000000000000000000f');
select to_int32(0, '00000000000000000000000000000000000000000000000fffffffffffffffff'); -- -1
select to_int32(0, '0000000000000000000000000000000000000000000000ffffffffffffffffff'); -- -1 still
select to_int32(0, '00000000000000000000000000000000000000000000000ffffffffffffffff1'); -- -15
select to_int32(0, 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff69'); -- -151
select to_int32(0, 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffb7c5'); -- -18491
select to_int32(0, 'ffffffffffffb7c5'); -- -18491
select to_int32(0, 'ff');

select to_int64(0, '0000000000000000000000000000000000000000000000000000000000000000');
select to_int64(0, '0000000000000000000000000000000000000000000000000000000000000001'); -- 1
select to_int64(0, '00000000000000000000000000000001'); -- 1 still
select to_int64(0, '1');
select to_int64(0, '0000000000000000000000000000000000000000000000000000000000000010');
select to_int64(0, '000000000000000000000000000000000000000000000000000000000000000f');
select to_int64(0, '00000000000000000000000000000000000000000000000fffffffffffffffff'); -- -1
select to_int64(0, '0000000000000000000000000000000000000000000000ffffffffffffffffff'); -- -1 still
select to_int64(0, '00000000000000000000000000000000000000000000000ffffffffffffffff1'); -- -15
select to_int64(0, 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff69'); -- -151
select to_int64(0, 'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffb7c5'); -- -18491
select to_int64(0, 'ffffffffffffb7c5'); -- -18491

select to_uint128(0, '0000000000000000000000000000000000000000000000000000000000000000');
select to_uint128(0, '0000000000000000000000000000000000000000000000000000000000000001');
select to_uint128(0, '0000000000000000000000000000000000000000000000000000000000000010');
select to_uint128(0, '0000000000000000000000000000000000000000000000010000000000000000'); -- 18446744073709551616
select to_uint128(0, '000000000000000000000000000000000000000000000001ffffffffffffffff'); -- 36893488147419103231
select to_uint128(0, '000000000000000000000000000000004B3B4CA85A86C47A098A223FFFFFFFFF'); -- 99999999999999999999999999999999999999 38 characters maximum decimal on redshift https://docs.aws.amazon.com/redshift/latest/dg/r_Numeric_types201.html#r_Numeric_types201-decimal-or-numeric-type
-- select to_uint128(0, '000000000000000000000000000000004B3B4CA85A86C47A098A224000000000'); -- 100000000000000000000000000000000000000 39 characters will fail overflow decimal on redshift
-- select to_uint128(0, '00000000000000000000000000000000ffffffffffffffffffffffffffffffff'); -- 340282366920938463463374607431768211455 ok on postgres but will fail on redshift as 39 characters will overflow decimal on redshift
-- select to_uint128(0, '0000000000000000000000000000000fffffffffffffffffffffffffffffffff'); -- 340282366920938463463374607431768211455 still on postgres

select can_convert_to_decimal(0, '000000000000000000000000000000004B3B4CA85A86C47A098A223FFFFFFFFF');
select can_convert_to_decimal(0, '000000000000000000000000000000014B3B4CA85A86C47A098A224000000000');

select to_decimal(0, '000000000000000000000000000000004B3B4CA85A86C47A098A223FFFFFFFFF');
select to_decimal(0, '000000000000000000000000000000014B3B4CA85A86C47A098A223FFFFFFFFF'); -- null to prevent overflow on redshift

select to_location(0, '0000000000000000000000000000000000000000000000000000000000000020');

select to_size(0, '0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000748656c6c6f252100000000000000000000000000000000000000000000000000');

select to_raw_bytes(0, '0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000748656c6c6f252100000000000000000000000000000000000000000000000000');

select to_bytes(0, '0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000748656c6c6f252100000000000000000000000000000000000000000000000000');

select to_bytes(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '0000000000000000000000000000000000000000000000000000000000000009' ||
                   '6761766f66796f726b0000000000000000000000000000000000000000000000');

select to_bytes(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '731a3afc00d1b1e3461b955e53fc866dcf303b3eb9f4c16f89e388930f48134b');

select to_bytes(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '000000000000000000000000000000000000000000000000000000000000009f' ||
                   'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff' ||
                   'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff' ||
                   'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff' ||
                   'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff' ||
                   'fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff100');

select to_fixed_bytes(0, '6761766f66796f726b0000000000000000000000000000000000000000000000', 32);

select to_fixed_bytes(0, '731a3afc00d1b1e3461b955e53fc866dcf303b3eb9f4c16f89e388930f48134b', 32);

select to_fixed_bytes(0, '02838654a83c213dae3698391eabbd54a5b6e1fb3452bc7fa4ea0dd5c8ce7e29', 32);

select to_fixed_bytes(0, 'c3a40000c3a40000000000000000000000000000000000000000000000000000', 32);

select to_fixed_bytes(0, 'cf00000000000000000000000000000000000000000000000000000000000000', 1);

select to_string(0, '0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000748656c6c6f252100000000000000000000000000000000000000000000000000');

select to_string(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                    '0000000000000000000000000000000000000000000000000000000000000009' ||
                    '6761766f66796f726b0000000000000000000000000000000000000000000000');

select to_string(0, '00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000026486565c3a4c3b6c3b6c3a4f09f9185443334c99dc9a33234d084cdbd2d2e2cc3a4c3bc2b232f0000000000000000000000000000000000000000000000000000');

select to_string(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                    '0000000000000000000000000000000000000000000000000000000000000002' ||
                    'c3bc000000000000000000000000000000000000000000000000000000000000');

select to_address(0, '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c1');

select to_address(0, '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c1' ||
                     '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c3');

select to_bool(0, '0000000000000000000000000000000000000000000000000000000000000001');
select to_bool(0, '0000000000000000000000000000000000000000000000000000000000000000');

select to_element(0, '0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000748656c6c6f252100000000000000000000000000000000000000000000000000', 'bytes');
select to_element(0, '0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000748656c6c6f252100000000000000000000000000000000000000000000000000', 'string');
select to_element(0, '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c1', 'address');
select to_element(0, '0000000000000000000000000000000000000000000000000000000000000020', 'int');
select to_element(0, '0000000000000000000000000000000000000000000000000000000000000001', 'bool');
select to_element(0, '0000000000000000000000000000000000000000000000000000000000000000', 'bool');

select to_element(0, '0000000000000000000000000000000000000000000000000000000000000003', 'int');

select to_size(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                  '0000000000000000000000000000000000000000000000000000000000000001' ||
                  '0000000000000000000000000000000000000000000000000000000000000003');

select to_element(128, '0000000000000000000000000000000000000000000000000000000000000020' ||
                       '0000000000000000000000000000000000000000000000000000000000000001' ||
                       '0000000000000000000000000000000000000000000000000000000000000003', 'int');

select to_array(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '0000000000000000000000000000000000000000000000000000000000000001' ||
                   '0000000000000000000000000000000000000000000000000000000000000003', 'int');

select to_array(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '0000000000000000000000000000000000000000000000000000000000000002' ||
                   '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c1' ||
                   '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c3', 'address');

select to_array(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '0000000000000000000000000000000000000000000000000000000000000003' ||
                   '0000000000000000000000000000000000000000000000000000000000000001' ||
                   '0000000000000000000000000000000000000000000000000000000000000002' ||
                   '0000000000000000000000000000000000000000000000000000000000000003', 'int');

select to_array(0, '0000000000000000000000000000000000000000000000000000000000000020' ||
                   '0000000000000000000000000000000000000000000000000000000000000003' ||
                   '0000000000000000000000000000000000000000000000000000000000000001' ||
                   '0000000000000000000000000000000000000000000000000000000000000001' ||
                   '0000000000000000000000000000000000000000000000000000000000000000', 'bool');

select to_fixed_array(0, '0000000000000000000000000000000000000000000000000000000000000001', 'bool', 1);

select to_fixed_array(0, '0000000000000000000000000000000000000000000000000000000000000000', 'bool', 1);

select to_fixed_array(0, '0000000000000000000000000000000000000000000000000000000000000001' ||
                         '0000000000000000000000000000000000000000000000000000000000000000', 'bool', 2);

select to_fixed_array(0, '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c1' ||
                         '000000000000000000000000407d73d8a49eeb85d32cf465507dd71d507100c3', 'address', 2);